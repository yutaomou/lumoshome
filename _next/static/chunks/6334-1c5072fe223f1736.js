"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6334],{1349:(e,t,n)=>{n.d(t,{A:()=>h,Z:()=>u});var r=n(95155),i=n(63438),l=n(12115),o=n(39688),a=n(77119),s=n(56518),c=n(6772);let d=[{isDefault:!0,value:"remi-v1",title:"ReMi lyrics model",ListComponent:()=>(0,r.jsxs)(c.B,{children:[(0,r.jsxs)("h3",{className:"pb-1 -mt-1",children:["ReMi"," ",(0,r.jsx)("span",{className:"inline-block relative top-1",children:(0,r.jsx)(s.A,{label:"Beta",auraImage:"/auras/Aura-13.jpg"})})]}),(0,r.jsx)("p",{className:"opacity-60",children:"Our newest, most creative model. May generate content that some find offensive."})]})},{value:"default",title:"Classic lyrics model",ListComponent:()=>(0,r.jsxs)(c.B,{children:[(0,r.jsx)("h3",{className:"pb-1",children:"Classic"}),(0,r.jsx)("p",{className:"opacity-60",children:"Follows prompts closely and takes fewer risks."})]})}],u=[{disabled:!0,value:"remi-v1",title:"ReMi lyrics model",ListComponent:()=>(0,r.jsxs)(c.B,{children:[(0,r.jsxs)("h3",{className:"pb-1 -mt-1",children:["ReMi"," ",(0,r.jsx)("span",{className:"inline-block relative top-1",children:(0,r.jsx)(s.A,{label:"Not available in Cowrite Editor",auraImage:"/auras/Aura-13.jpg"})})]}),(0,r.jsx)("p",{className:"opacity-60",children:"Our newest, most creative model. May generate content that some find offensive."})]})},{isDefault:!0,value:"default",title:"Classic lyrics model",ListComponent:()=>(0,r.jsxs)(c.B,{children:[(0,r.jsx)("h3",{className:"pb-1",children:"Classic"}),(0,r.jsx)("p",{className:"opacity-60",children:"Follows prompts closely and takes fewer risks."})]})}],p=[{value:"ft-v1",title:"ft-v1"},{value:"dusanbot2",title:"DusanBot2"},{value:"remi-v1",title:"ReMi"},{value:"lorenzo-v1",title:"Lorenzo"},{value:"gemini-2.0",title:"Gemini 2.0"}].map(e=>{let{title:t,value:n}=e;return{value:n,title:t,ListComponent:()=>(0,r.jsxs)(c.B,{children:[(0,r.jsxs)("h3",{className:"pb-1",children:[t," ",(0,r.jsx)("span",{className:"inline-block relative top-1",children:(0,r.jsx)(s.A,{label:"Dev",auraImage:"/auras/Aura-13.jpg"})})]}),(0,r.jsx)("p",{className:"opacity-60",children:n})]})}}),h=(0,i.PA)(e=>{var t;let{menuClassName:n,className:i,options:s,...u}=e,{session:h}=(0,a.gy)(),x=null===(t=h.flags)||void 0===t?void 0:t.configs,m=(0,l.useMemo)(()=>[...d,...x?p:[]],[x]);return(0,r.jsx)(c.A,{...u,className:(0,o.QP)("whitespace-nowrap overflow-hidden",i),menuClassName:(0,o.QP)("text-sm w-80",n),options:s||m})})},6772:(e,t,n)=>{n.d(t,{A:()=>p,B:()=>u});var r=n(95155),i=n(6798),l=n(52596),o=n(12115),a=n(47650),s=n(39688),c=n(74955);let d=e=>null==e?null:e.scrollHeight>e.clientHeight?e:d(e.parentNode),u=e=>(0,r.jsx)("div",{...e,className:(0,s.QP)("rounded-md px-2 py-1 hover:bg-[#ffffff22]",e.className)}),p=e=>{let{value:t,onSetValue:n,options:u,menuClassName:p,onClick:h,...x}=e,m=(0,o.useMemo)(()=>u.find(e=>e.value===t)||u.find(e=>e.isDefault)||u[0],[u,t]),[f,g]=(0,o.useState)(!1),y=(0,o.useCallback)(e=>{n(e.value),g(!1)},[n]),v=(0,o.useCallback)(e=>{h&&h(e),g(e=>!e)},[h]),b=(0,o.useRef)(null),k=(0,o.useRef)(null);(0,i.useOutsideClick)({ref:k,handler:e=>{var t;e.target&&!(null===(t=b.current)||void 0===t?void 0:t.contains(e.target))&&f&&g(!1)}});let C=(0,o.useCallback)((e,t)=>{let n=t.getBoundingClientRect(),r=n.top+n.height+4+document.body.scrollTop,i=n.left+document.body.scrollLeft,l=e.getBoundingClientRect(),o=r+l.height+8,a=i+l.width+8;o>window.innerHeight&&(r=n.top-l.height-4),a>window.innerWidth&&(i-=a-window.innerWidth),e.setAttribute("style","top: ".concat(r,"px; left: ").concat(i,"px;"))},[]),w=(0,o.useCallback)(e=>{let t=b.current;setTimeout(()=>{k.current=e,e&&t&&C(e,t)},0)},[C]);return((0,o.useEffect)(()=>{let e=d(b.current);if(!e)return;let t=()=>{k.current&&b.current&&C(k.current,b.current)};return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}),m)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.Ay,{ref:b,shape:c.aH.Pill,size:c.Mp.Small,variant:c.Ak.Secondary,...x,onClick:v,children:[m.title,(0,r.jsx)("svg",{className:(0,l.A)("h-4 w-4 inline-block transition-transform",{"rotate-0":!f,"rotate-180":f}),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06 0L10 10.93l3.71-3.72a.75.75 0 111.06 1.06l-4.25 4.25a.75.75 0 01-1.06 0L5.23 8.27a.75.75 0 010-1.06z",clipRule:"evenodd"})})]}),f&&a.createPortal((0,r.jsx)("div",{className:(0,s.QP)("absolute bg-tertiary z-[1500] rounded-lg shadow-lg shadow-[0_2px_16px_rgba(0,0,0,0.5)] p-1",p),ref:w,children:u.map(e=>(0,r.jsxs)("div",{className:(0,l.A)("cursor-pointer mt-2 first:mt-0 relative",{"pointer-events-none":e.disabled,"opacity-50":e.disabled}),onClick:e.disabled?void 0:t=>{y(e),t.stopPropagation()},children:[(0,r.jsx)(e.ListComponent,{}),e===m&&(0,r.jsx)("svg",{className:"absolute top-3 right-2",width:"16",height:"12",viewBox:"0 0 16 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M16 1.66109L15.1712 2.44697L6.46573 10.6917L5.67984 11.4347L4.89395 10.6917L0.828756 6.84439L0 6.0585L1.57178 4.39741L2.40054 5.1833L5.67984 8.28756L13.5995 0.78589L14.4282 0L16 1.66109Z",fill:"#BAB4B1"})})]},e.value))}),document.body)]}):null}},8053:(e,t,n)=>{n.d(t,{A:()=>s,S:()=>a});var r=n(12115),i=n(77119),l=n(63808),o=n(15259);let a=(e,t)=>{let{genForm:n}=(0,i.gy)();(0,o.A)({actionName:"LyricsCowriteModalViewedLyricsOption",principalObjectType:"lyrics",principalObjectValue:e,context:{lyricsRequestId:t,generateInstanceToken:n.createSessionToken}})},s=()=>{let{genForm:e}=(0,i.gy)(),t=(0,r.useCallback)((t,n)=>{(0,l.Ay)({actionName:"LyricsCowriteModalLyricsGenerationInitiated",principalObjectType:"lyrics_request",principalObjectValue:t,context:{prompt:n.prompt,lyricsModel:n.lyricsModel,generateInstanceToken:e.createSessionToken}})},[e.createSessionToken,l.Ay]),n=(0,r.useCallback)((t,n)=>{(0,l.Ay)({actionName:"LyricsCowriteModalLyricsGenerationError",context:{prompt:n.prompt,lyricsModel:n.lyricsModel,error:t.message,generateInstanceToken:e.createSessionToken}})},[e.createSessionToken,l.Ay]),o=(0,r.useCallback)((t,n)=>{(0,l.Ay)({actionName:"LyricsCowriteModalAcceptLyricsOptionClicked",context:{generateInstanceToken:e.createSessionToken,lyricsId:n,lyricsRequestId:t}})},[e.createSessionToken,l.Ay]),a=(0,r.useCallback)(t=>{(0,l.Ay)({actionName:"LyricsCowriteModalEscapeKey",principalObjectType:"lyrics_request",principalObjectValue:t,context:{generateInstanceToken:e.createSessionToken}})},[e.createSessionToken,l.Ay]),s=(0,r.useCallback)(()=>{(0,l.Ay)({actionName:"LyricsCowriteModalEnterKey",context:{generateInstanceToken:e.createSessionToken}})},[e.createSessionToken,l.Ay]),c=(0,r.useCallback)(t=>{(0,l.Ay)({actionName:"LyricsCowriteModalGenerateCancelButtonClicked",context:{generateInstanceToken:e.createSessionToken,lyricsRequestId:t}})},[e.createSessionToken,l.Ay]),d=(0,r.useCallback)(t=>{(0,l.Ay)({actionName:"LyricsCowriteModalLyricsModelSelectorClicked",context:{generateInstanceToken:e.createSessionToken,lyricsModel:t}})},[e.createSessionToken,l.Ay]),u=(0,r.useCallback)((t,n,r)=>{(0,l.Ay)({actionName:"LyricsCowriteModalGenerateButtonClicked",context:{prompt:t,lyricsModel:n,lastLyricsRequestId:r,generateInstanceToken:e.createSessionToken}})},[e.createSessionToken,l.Ay]);return{logGenerationInitiated:t,logGenerationError:n,logLyricsAccepted:o,logEscapeKey:a,logEnterKey:s,logCancelButton:c,logModelSelectorClick:d,logGenerateButtonClick:u,logMobileOptionTabClick:(0,r.useCallback)(t=>{(0,l.Ay)({actionName:"LyricsCowriteModalMobileLyricsOptionTabClicked",context:{lyricsId:t,generateInstanceToken:e.createSessionToken}})},[e.createSessionToken,l.Ay]),logLyricsModalClose:(0,r.useCallback)(t=>{(0,l.Ay)({actionName:"LyricsCowriteModalCloseButtonClicked",context:{generateInstanceToken:e.createSessionToken,lastLyricsRequestId:t}})},[e.createSessionToken,l.Ay])}}},10250:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(5041),i=n(12115),l=n(77119),o=n(20084),a=n(95838);function s(e){let{genForm:t}=(0,l.gy)(),n=(0,i.useRef)(e),r=(0,i.useCallback)(()=>n.current=e,[e]),o=(0,a.useQuery)({enabled:!!e,queryKey:["lyrics",e],queryFn:async()=>{if(!e||n.current===e)return;let r=await t.apiClient.GET("/api/generate/lyrics/{lyrics_id}",{params:{path:{lyrics_id:e}}});if(r.error)throw Error(r.error);if("error"===r.data.status)throw Error(r.data.error_message);return r.data},refetchInterval:t=>{var r,i;return!!e&&n.current!==e&&!t.state.error&&(null===(r=t.state.data)||void 0===r?void 0:r.status)!=="complete"&&(null===(i=t.state.data)||void 0===i?void 0:i.status)!=="error"&&2500}});return(0,i.useMemo)(()=>({data:o.data&&e?{...o.data,id:e}:void 0,error:o.error,cancel:r}),[o.data,o.error,e,r])}var c=n(8053);let d=()=>{var e,t,n;let{genForm:a}=(0,l.gy)(),d=(0,c.A)(),u=a.lyricsPrompt,p=a.setLyricsPrompt,h=a.lyricsModel,x=a.setLyricsModel,[m,f]=(0,i.useState)(null),[g,y]=(0,i.useState)(!1),v=function(){let{genForm:e}=(0,l.gy)();return(0,i.useCallback)(async t=>{let{lyricsModel:n,prompt:r}=t,i=await e.apiClient.POST("/api/generate/lyrics-pair",{body:{prompt:r,lyrics_model:n,create_session_token:e.createSessionToken}});if(i.error){var l;throw Error((null===(l=i.error)||void 0===l?void 0:l.message)||i.error||"Unknown error")}return{requestId:i.data.lyrics_request_id,lyricsAId:i.data.lyrics_a_id,lyricsBId:i.data.lyrics_b_id}},[e.createSessionToken,e.apiClient])}(),b=(0,r.useMutation)({mutationFn:(0,i.useCallback)(e=>(y(!1),v(e)),[v]),onSuccess:(e,t)=>d.logGenerationInitiated(e.requestId,t),onError:(e,t)=>{(0,l.oR)({...(0,o.A)(e.message),status:"error",duration:4e3,isClosable:!0}),d.logGenerationError(e,t)}}),[k,C]=(0,i.useState)(!1),[w,j]=(0,i.useState)(!1),N=function(){let{genForm:e}=(0,l.gy)();return(0,i.useCallback)(async t=>{let{requestId:n,preferredLyricsId:r}=t,i=await e.apiClient.POST("/api/generate/lyrics-pair/rate",{body:{lyrics_request_id:n,preferred_lyrics_id:r}});if(i.error)throw Error(i.error);return i.data},[e.apiClient])}(),A=(0,i.useCallback)(e=>{let{requestId:t,preferredLyricsId:n}=e;k&&w&&N({requestId:t,preferredLyricsId:n})},[k,w,N]),T=(0,i.useCallback)(e=>{m!==e&&(f(e),a.lastLyricsGeneration=null,A({requestId:e,preferredLyricsId:null}))},[m,a,A]),{data:S,cancel:L,error:E}=s(null===(e=b.data)||void 0===e?void 0:e.lyricsAId),{data:M,cancel:I,error:_}=s(null===(t=b.data)||void 0===t?void 0:t.lyricsBId),R=(0,i.useCallback)(()=>{y(!0),L(),I()},[L,I]),P=(0,i.useMemo)(()=>E||_,[E,_]);(0,i.useEffect)(()=>{P&&((0,l.oR)({...(0,o.A)(P.message),status:"error",duration:4e3,isClosable:!0}),R())},[P,R]);let F=!g&&(b.isPending||b.data&&(!(null==S?void 0:S.text)||!(null==M?void 0:M.text))),z=(0,i.useCallback)(async e=>{await b.mutate({prompt:e||u,lyricsModel:h})},[u,h,b]),q=(0,i.useCallback)((e,t)=>{if(f(e),a.setLyrics(t.text),a.setTitle(t.title),b.variables){var n,r;a.lastLyricsGeneration={title:t.title,lyrics:t.text,prompt:null===(n=b.variables)||void 0===n?void 0:n.prompt,lyricsModel:null===(r=b.variables)||void 0===r?void 0:r.lyricsModel}}A({requestId:e,preferredLyricsId:t.id})},[a,b.variables,A]);return(0,i.useMemo)(()=>{var e;return{prompt:u,setPrompt:p,lyricsModel:h,setLyricsModel:x,generate:z,generating:F,cancel:R,generationCancelled:g,rejectLyricsIfNoneAccepted:T,lyricsA:S,lyricsB:M,setLyricsADisplayed:C,setLyricsBDisplayed:j,handleAcceptLyrics:q,requestId:null===(e=b.data)||void 0===e?void 0:e.requestId}},[u,p,h,x,z,F,R,g,T,S,M,C,j,q,null===(n=b.data)||void 0===n?void 0:n.requestId])}},15259:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(60245),i=n.n(r),l=n(12115),o=n(63808);function a(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=(0,l.useRef)(null);(0,l.useEffect)(()=>{!t||i()(n.current,e)||(n.current=e,(0,o.Ay)(e))},[e,t])}},15307:(e,t,n)=>{n.d(t,{A:()=>d,d:()=>c});var r=n(95155),i=n(52596),l=n(12115),o=n(98115),a=n(39688),s=n(53043),c=function(e){return e.Always="Always",e.WhenCloseToFull="WhenCloseToFull",e.Never="Never",e}({});let d=(0,l.forwardRef)(function(e,t){let{maxLength:n,value:c,charCountMode:d="WhenCloseToFull",resize:u=!1,readOnly:p,className:h,textAreaClassName:x,disabled:m,...f}=e,g=(0,l.useMemo)(()=>{if("Never"===d||!n)return!1;if("Always"===d)return!0;if("WhenCloseToFull"===d)return c.length>=.8*n;throw Error("Invalid charCountMode: ".concat(d))},[d,n,c.length]);return(0,r.jsxs)("div",{className:(0,a.QP)("relative rounded-lg border border-quaternary overflow-hidden flex-1 bg-tertiary p-0.5",h),children:[(0,r.jsx)(o.A,{ref:t,className:(0,a.QP)((0,i.A)("block w-full focus:outline-none custom-textarea font-sans text-[16px] p-3 bg-inherit placeholder-lighterGray",{"text-primary":!m,"text-lightGray":m,cursor:p?"not-allowed":"text","resize-vertical":u,"resize-none":!u,"overflow-hidden":!u,"overflow-auto":u,"pb-[1rem]":!g,"pb-[1.8rem]":g}),x),disabled:m,maxLength:n,value:c,readOnly:p,...f}),g&&(0,r.jsx)(s.A,{className:"font-sans absolute bottom-2 right-2 text-sm bg-inherit bg-o-50",okayClassName:"text-secondary",errorClassName:"text-red-500",length:c.length,maxLength:null!=n?n:1/0})]})})},23949:(e,t,n)=>{var r,i;n.d(t,{A:()=>l});let l="undefined"!=typeof navigator&&(null===(i=navigator)||void 0===i?void 0:null===(r=i.platform)||void 0===r?void 0:r.startsWith("Mac"))?"⌘":"ctrl"},24874:(e,t,n)=>{n.d(t,{A:()=>m});var r=n(95155),i=n(52596),l=n(12115),o=n(74692),a=n(77119),s=n(56108),c=n(50649),d=n(63808),u=n(74955),p=n(89232),h=n(91303),x=n(15307);let m=e=>{var t;let{maxLyricsLength:n=3e3,lyrics:m,setLyrics:f,lyricsInputDisallowed:g,onLyricsInputInteraction:y}=e,[v,b]=(0,o.Mj)("has-opened-cowrite-editor-jan-27-2025-v2",!1),[k,C]=(0,l.useState)(!1),[w,j]=(0,l.useState)(!1),{genForm:N,session:A}=(0,a.gy)(),T=!!(0,s.Yo)()&&!!(null==A?void 0:null===(t=A.flags)||void 0===t?void 0:t["lyrics-cowrite-editor"]),S=(0,o.DE)();return(0,r.jsxs)("div",{className:(0,i.A)("relative rounded-lg bg-quaternary",{"mt-3":S&&!v}),children:[T&&(0,r.jsxs)("div",{className:"pl-4 flex items-center gap-1",children:[(0,r.jsx)("div",{className:"text-sm flex-grow text-secondary",children:"Write with Suno"}),(0,r.jsx)(u.Ay,{className:"py-1.5 px-3",size:u.Mp.Mini,variant:u.Ak.Tertiary,onClick:()=>{C(!0),(0,d.Ay)({actionName:"LyricsCowriteButtonClicked",context:{generateInstanceToken:N.createSessionToken}})},icon:(0,r.jsx)(c.Sup,{className:"text-fadedPink w-3 h-3"}),children:"Full Song"}),(0,r.jsxs)(u.Ay,{className:"py-1.5 px-3 relative",size:u.Mp.Mini,variant:v?u.Ak.Tertiary:u.Ak.Aura,onClick:()=>{j(!0),b(!0),(0,d.Ay)({actionName:"LyricsCowriteEditorButtonClicked",context:{generateInstanceToken:N.createSessionToken}})},icon:(0,r.jsx)(c.Sup,{className:(0,i.A)("w-3 h-3",{"text-fadedPink":v,"text-white":!v})}),children:["By Line",!v&&(0,r.jsx)("div",{className:"absolute -top-[15px] -right-5 text-xs ",children:(0,r.jsx)("span",{className:"inline-block px-1 text-black bg-white border rounded-sm",children:"New!"})})]})]}),(0,r.jsx)(x.A,{maxLength:n,value:m,disabled:k||w,resize:!0,charCountMode:x.d.Always,onClick:()=>null==y?void 0:y(),onKeyDown:e=>{null==y||y(),g&&e.preventDefault()},onChange:e=>{f(e.target.value)},placeholder:"Enter your own lyrics",rows:9,className:"pb-10",textAreaClassName:(0,i.A)("focus:outline-0",{"blur-0":!k&&!w,"blur-[3px] pointer-events-none":k||w})}),!T&&(0,r.jsx)("div",{className:"absolute bottom-1 left-1 right-3 p-1",children:(0,r.jsx)(u.Ay,{size:u.Mp.Small,shape:u.aH.Pill,onClick:()=>{C(!0),(0,d.Ay)({actionName:"LyricsCowriteButtonClicked",context:{generateInstanceToken:N.createSessionToken}})},icon:(0,r.jsx)(c.Sup,{className:"text-fadedPink w-3 h-3"}),children:"Write with Suno"})}),(0,r.jsx)(h.A,{isOpen:k,onClose:()=>{C(!1)}}),(0,r.jsx)(p.A,{isOpen:w,onClose:()=>{j(!1)}})]})}},41753:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(32532);function i(e,t){let n=e.getFirstChild(),i=null,l=0;e:for(;null!==n;){if((0,r.ff)(n)){let e=n.getFirstChild();if(null!==e){n=e;continue}}else if((0,r.kF)(n)){i=n;let e=n.getTextContentSize();if(l+e>t)return{node:n,offset:Math.max(t-l,0)};l+=e}else if((0,r.wH)(n)){if(i&&l+1>t)return{node:i,offset:i.getTextContentSize()};l+=1}let e=n.getNextSibling();if(null!==e){n=e;continue}let o=n.getParent();for(;null!==o;){let e=o.getNextSibling();if(null!==e){n=e;continue e}o=o.getParent()}break}return i?{node:i,offset:i.getTextContentSize()}:null}},53043:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(95155),i=n(52596),l=n(39688);let o=e=>{let{className:t,okayClassName:n="text-inherit",errorClassName:o="text-red-500",warningClassName:a=o,length:s=0,maxLength:c=1/0,visibleThreshold:d=0,visibleLength:u=d*c,warningThreshold:p=1,warningLength:h=p*c,...x}=e;return(0,r.jsxs)("div",{className:(0,l.QP)((0,i.A)("font-sans text-sm transition-opacity duration-100",n,{"opacity-0":s<u,[a]:s>=h},{[o]:s>c}),t),...x,children:[s," / ",c===1/0?"∞":c]})}},56108:(e,t,n)=>{n.d(t,{Ay:()=>s,Nz:()=>a,Yo:()=>l,gs:()=>o});var r=n(74692),i=n(7132);function l(){return s(i.j3)}function o(){return s(i.Vm)}function a(){return s(i.YC)}function s(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,r.Ub)("(min-width: ".concat(e,"px)"),{initializeWithValue:t})}},80377:(e,t,n)=>{n.d(t,{m:()=>o});var r=n(95155),i=n(274),l=n(7132);let o=e=>{let{label:t,children:n,placement:o}=e;return(0,r.jsx)(i.Tooltip,{fontFamily:"Neue Montreal",label:t,size:"sm",placement:o,background:l.TJ,backdropFilter:"blur(40px)",rounded:"md",color:"#ffffff",padding:"10px",children:n})}},89232:(e,t,n)=>{n.d(t,{A:()=>eN});var r=n(95155),i=n(46752),l=n(5520),o=n(16299),a=n(52596),s=n(63438),c=n(77119),d=n(63808),u=n(74955),p=n(15933),h=n(32643),x=n(61715),m=n(33964),f=n(94271),g=n(5041),y=n(32532),v=n(12115),b=n(74692);let k=()=>{let{genForm:e}=(0,c.gy)();return(0,v.useCallback)(async t=>{var n;let{prompt:r,prefix:i,edit:l,suffix:o,title:a}=t,s=await e.apiClient.POST("/api/generate/lyrics-infill/",{body:{prompt:r,context_lyrics_prefix:i,context_lyrics_edit:l,context_lyrics_suffix:o,create_session_token:e.createSessionToken,title:a}}),c=null===(n=s.data)||void 0===n?void 0:n.generated_lyrics;if(!c)throw console.log(s),Error("Failed to regenerate text");let d=c;return c.startsWith("[")&&i.trim()&&!i.endsWith("\n")&&(d="\n"+d),l.endsWith("\n")&&!d.endsWith("\n")&&(d+="\n"),!l&&!o.trim()&&i.trim()&&!d.startsWith("\n")&&(d="\n"+d),{replacedText:d,fullText:i+d+o,lyricsRequestId:s.data.lyrics_request_id,lyricsId:s.data.lyrics_id}},[e.apiClient])};var C=n(50649),w=n(23949),j=n(1349),N=n(97942),A=n(15307),T=n(80377),S=n(41753),L=n(53219),E=n(76598),M=n(31705),I=n(39878);function _(){let e=(0,p._)(["\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n  right: 0;\n  ","\n  height: ","px;\n  background-image: linear-gradient(\n    to ",",\n    ","ff 0%,\n    ","ff\n      ","%,\n    ","00 100%\n  );\n"]);return _=function(){return e},e}let R=x.A.div(_(),e=>{let{above:t}=e;return t?"top: 0;":"bottom: 0;"},e=>{let{height:t,fadeHeight:n}=e;return t+n},e=>{let{above:t}=e;return t?"bottom":"top"},e=>{let{color:t}=e;return t},e=>{let{color:t}=e;return t},e=>{let{height:t,fadeHeight:n}=e;return 100*t/(t+n)},e=>{let{color:t}=e;return t});class P extends y.Ey{static getType(){return"sectionHeading"}static clone(e){return new P(e.__text,e.__key)}createDOM(){let e=document.createElement("span");return e.className="section-heading",e.innerText=this.__text,e}}let F=e=>new P(e);function z(e){let t=-1,n=-1;for(let r=0;r<e.length;r++)if("["===e[r]&&(t=r),t>-1&&"]"===e[r]&&(n=r),t>=0&&n>=0)return{position:t,text:e.slice(t,n+1)};return null}function q(e){let t;if(!e.isSimpleText()||e.hasFormat("code"))return;let n=z(e.getTextContent());if(null===n)return;0===n.position?[t]=e.splitText(n.position+n.text.length):[,t]=e.splitText(n.position,n.position+n.text.length);let r=F(n.text);t.replace(r)}function B(e){let t,n;let r=e.getTextContent(),i=z(r);if(null===i){let t=(0,y.sT)(r);e.replace(t);return}if(0===i.position?[,t]=e.splitText(i.position+i.text.length):[t,,n]=e.splitText(i.position,i.position+i.text.length),t){let e=(0,y.sT)(t.getTextContent());t.replace(e)}if(n){let e=(0,y.sT)(n.getTextContent());n.replace(e)}}let O=()=>{let[e]=(0,f.DF)();return(0,v.useEffect)(()=>{if(!e.hasNodes([P]))throw Error("SectionHeadingPlugin: SectionHeadingNode not registered on editor");return function(e){let t=[e.registerNodeTransform(y.Ey,q),e.registerNodeTransform(P,B)];return()=>{t.forEach(e=>e())}}(e)}),null};var W=n(61731);let H=e=>{let{onSelectionUpdate:t,onScroll:n}=e,[r]=(0,f.DF)(),i=(0,v.useCallback)(()=>{r.read(()=>{var e;let n=(0,y.vJ)(),i=null===(e=r.getRootElement())||void 0===e?void 0:e.getBoundingClientRect();if(i&&(0,y.I2)(n)){let e=(0,W.cb)(r,n.anchor.getNode(),n.anchor.offset,n.focus.getNode(),n.focus.offset),l=!1;if((null==e?void 0:e.endContainer)===(null==e?void 0:e.startContainer)&&(null==e?void 0:e.endOffset)===(null==e?void 0:e.startOffset)&&(l=!0,e=(0,W.cb)(r,n.anchor.getNode(),n.anchor.offset,n.focus.getNode(),n.focus.offset+1)||e),!e)return;let o=(0,W.zT)(r,e);if(!o.length)return;let a=o.filter(e=>e.width>0),s=0===a.length?o:a,c=Math.min(...s.map(e=>e.left)),d=Math.min(...s.map(e=>e.top)),u=Math.max(...s.map(e=>e.right)),p=Math.max(...s.map(e=>e.bottom));t(new DOMRect(c-i.left,d-i.top-2,l?0:u-c,p-d+5))}})},[r,t]);return(0,b.$$)(i,250),(0,v.useEffect)(()=>{let e=r.registerUpdateListener(()=>{i();let t=()=>{},l=r.getRootElement(),o=null==l?void 0:l.parentElement;if(o){let e=()=>{n(o.scrollTop)};o.addEventListener("scroll",e),t=()=>{o.removeEventListener("scroll",e)}}return()=>{e(),t()}})},[n,i,r]),null};function D(){let e=(0,p._)(["\n  position: relative;\n  min-height: 0;\n"]);return D=function(){return e},e}function G(){let e=(0,p._)(["\n  padding: 20px 0 60px 0;\n  overflow-y: scroll;\n  height: 100%;\n  > [contenteditable] {\n    width: 100%;\n    min-height: 100%;\n    &:focus {\n      outline: none;\n    }\n  }\n  .section-heading {\n    opacity: 0.5;\n  }\n"]);return G=function(){return e},e}function U(){let e=(0,p._)(["\n  position: absolute;\n  top: 20px;\n  left: 0;\n  opacity: 50%;\n  pointer-events: none;\n"]);return U=function(){return e},e}let Y=x.A.div(D()),K=x.A.div(G()),X=x.A.div(U()),J={namespace:"LyricsEditor",theme:{paragraph:".editor-paragraph"},onError:function(e){console.error(e)},nodes:[P]},V=(0,r.jsx)(X,{children:"Enter some text..."}),Q=(0,v.memo)(function(e){let{onSelectionUpdate:t}=e,n=(0,v.useRef)(new DOMRect(0,0,0,19.5)),i=(0,v.useRef)(0),l=(0,v.useCallback)(()=>{t(n.current,i.current)},[t]),o=(0,v.useCallback)(e=>{n.current=e,l()},[l]),a=(0,v.useCallback)(e=>{i.current=e,l()},[l]);return(0,r.jsxs)(Y,{children:[(0,r.jsxs)(K,{children:[(0,r.jsx)(I.h,{contentEditable:(0,r.jsx)(L.a,{}),placeholder:V,ErrorBoundary:E.R}),(0,r.jsx)(M.G,{}),(0,r.jsx)(O,{}),(0,r.jsx)(H,{onSelectionUpdate:o,onScroll:a})]}),(0,r.jsx)(R,{above:!0,height:0,fadeHeight:30,color:"#363030"}),(0,r.jsx)(R,{above:!1,height:0,fadeHeight:30,color:"#363030"})]})});function Z(){let e=(0,p._)(["\n  position: absolute;\n  right: 0;\n  left: 0;\n  z-index: 2;\n  transition:\n    height 0.1s ease,\n    top 0.1s ease;\n  .bracket {\n    border: 2px solid #f172a4;\n    position: absolute;\n    width: 10px;\n  }\n  .top-right-corner.bracket {\n    border-bottom-width: 0;\n    border-right-width: 0;\n    top: 0;\n    bottom: 75%;\n    right: 0;\n    border-top-left-radius: 20px;\n  }\n  .top-left-corner.bracket {\n    border-top-width: 0;\n    border-left-width: 0;\n    top: 25%;\n    bottom: calc(50% - 1px);\n    right: 8px;\n    border-bottom-right-radius: 20px;\n  }\n  .bottom-left-corner.bracket {\n    border-bottom-width: 0;\n    border-left-width: 0;\n    top: calc(50% - 1px);\n    bottom: 25%;\n    right: 8px;\n    border-top-right-radius: 20px;\n  }\n  .bottom-right-corner.bracket {\n    border-top-width: 0;\n    border-right-width: 0;\n    bottom: 0;\n    top: 75%;\n    right: 0;\n    border-bottom-left-radius: 20px;\n  }\n  .rewrite-overlay {\n    position: absolute;\n    pointer-events: none;\n    opacity: ",";\n    background-color: #f172a444;\n    left: 100%;\n    width: 100vw;\n    height: 100%;\n    z-index: 10;\n    transition:\n      opacity 0.2s ease,\n      backdrop-filter 0.2s ease;\n    backdrop-filter: ",";\n  }\n  .children-container {\n    position: absolute;\n    right: 18px;\n    left: 10px;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n"]);return Z=function(){return e},e}let $=(e,t,n)=>{let r=t.current;if(!r)return;let i=r.parentElement.getBoundingClientRect(),l=i.top+20;r.style.top="".concat(e.top+l,"px"),r.style.height=e.height+"px",r.style.transform="translateY(".concat(-1*n,"px)");let o=r.querySelector(".children-container");if(!o)return;let a=e.top+l-n+e.height/2-o.offsetHeight/2,s=a+o.offsetHeight,c=i.height-64,d=0;a<0?d=-1*a:s>c&&(d=c-s),0===d?o.style.transform="":o.style.transform="translateY(calc(-50% + ".concat(d,"px))")},ee=x.A.div(Z(),e=>{let{emphasizeSelection:t}=e;return+!!t},e=>{let{obscureSelection:t}=e;return t?"blur(7px)":"blur(0)"}),et=(0,v.forwardRef)(function(e,t){let{obscureSelection:n,emphasizeSelection:i,hide:l,children:o}=e,a=v.useRef(null),s=(0,v.useCallback)(e=>{a.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]);return(0,r.jsxs)(ee,{ref:s,obscureSelection:n,emphasizeSelection:i,children:[!l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bracket top-right-corner"}),(0,r.jsx)("div",{className:"bracket top-left-corner"}),(0,r.jsx)("div",{className:"bracket bottom-left-corner"}),(0,r.jsx)("div",{className:"bracket bottom-right-corner"}),(0,r.jsx)("div",{className:"rewrite-overlay"})]}),(0,r.jsx)("div",{className:"children-container",children:o})]})});function en(){let e=(0,p._)(["\n  padding: 3px 0 8px 0;\n  border: none;\n  background-color: inherit;\n  color: inherit;\n  width: 100%;\n  border-bottom: 1px solid #888;\n  &:focus {\n    outline: none;\n  }\n"]);return en=function(){return e},e}function er(){let e=(0,p._)(["\n  font-family: PP Editorial New;\n  font-size: 32px;\n  flex-grow: 0;\n  margin: 0;\n  position: relative;\n  padding-bottom: 0;\n  z-index: 2;\n"]);return er=function(){return e},e}function ei(){let e=(0,p._)(["\n  display: grid;\n  grid-template-columns: 255px 1fr;\n  height: 100%;\n  min-height: 0;\n"]);return ei=function(){return e},e}function el(){let e=(0,p._)(["\n  position: relative;\n"]);return el=function(){return e},e}function eo(){let e=(0,p._)(["\n  position: relative;\n  display: grid;\n  grid-template-rows: auto 1fr auto;\n  min-height: 0;\n  overflow: hidden;\n  p,\n  span {\n    ::selection {\n      transition: background-color 0.2s ease;\n      background-color: ",";\n    }\n  }\n  &:before {\n    content: '';\n    display: block;\n    background-color: inherit;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 64px;\n    z-index: 2;\n  }\n"]);return eo=function(){return e},e}function ea(){let e=(0,p._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  border: none;\n  border-radius: 5px;\n  background-color: #363030;\n  min-height: 80px;\n  padding: 10px;\n  input {\n    margin-bottom: 8px;\n  }\n  box-shadow: -8px 0px 24px 12px rgb(var(--rgb-gray-100));\n"]);return ea=function(){return e},e}function es(){let e=(0,p._)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: absolute;\n  top: 0;\n  bottom: 60px;\n  left: 0;\n  right: 0;\n  padding: 0 40px;\n  opacity: 25%;\n  text-align: center;\n"]);return es=function(){return e},e}function ec(){let e=(0,p._)(["\n  grid-row: 3 / 4;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  > * {\n    height: 100%;\n  }\n"]);return ec=function(){return e},e}function ed(){let e=(0,p._)(["\n  position: absolute;\n  top: 50%;\n  left: 0;\n  right: 0;\n  transform: translateY(-50%);\n  padding: 10px;\n  color: #666;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 10px;\n"]);return ed=function(){return e},e}let eu=x.A.input(en()),ep=(0,x.A)(eu)(er()),eh=x.A.div(ei()),ex=x.A.div(el()),em=x.A.div(eo(),e=>{let{hideSelection:t}=e;return t?"transparent":"#f172a466"}),ef=x.A.div(ea()),eg=x.A.div(es()),ey=x.A.div(ec()),ev=e=>{e.stopPropagation(),e.preventDefault()},eb=x.A.div(ed()),ek=["Write a verse about a dog","Write a thoughtful chorus","Add four lines about wind","Gimme something catchy","Get spooky"],eC=["Make this wittier","Make this rhyme","Shorten this, 3 words max","Make this more emotional","Make this less literal"],ew=(0,s.PA)(e=>{let{content:t,onSubmit:n}=e,{genForm:i}=(0,c.gy)(),[l]=(0,f.DF)(),[o,a]=(0,v.useState)(!1),[s,p]=(0,v.useState)(!1),[x,m]=(0,v.useState)(null),[L,E]=(0,v.useState)(!1),[M,I]=(0,v.useState)(!1);(0,v.useEffect)(()=>{l.update(()=>{(0,y.Ni)().clear(),(0,y.Ni)().selectStart();let e=(0,y.vJ)();null==e||e.insertRawText(t.lyrics),(0,y.Ni)().selectStart()})},[l,t.lyrics]);let _=(0,v.useRef)(null),P=(0,v.useCallback)((e,t)=>{$(e,_,t),null==l||l.read(()=>m((0,y.vJ)()))},[l]),F=k(),z=(0,v.useCallback)(()=>{var e;null==l||l.setEditable(!0),null==l||null===(e=l.getRootElement())||void 0===e||e.removeEventListener("mousedown",ev)},[l]),q=(0,v.useCallback)(()=>{var e;null==l||l.setEditable(!1),null==l||null===(e=l.getRootElement())||void 0===e||e.addEventListener("mousedown",ev)},[l]),[B,O]=(0,v.useState)(null),W=(0,v.useRef)(null),H=(0,g.useMutation)({mutationFn:(0,v.useCallback)(e=>(W.current=new AbortController,I(!1),q(),F(e)),[l,F]),onSuccess:async(e,t)=>{var n;let{replacedText:r,lyricsId:o,lyricsRequestId:a}=e,{prefix:s,edit:c,infillTransactionLogger:d}=t;z(),(null===(n=W.current)||void 0===n||!n.signal.aborted)&&l&&l.update(()=>{let e=(0,y.vJ)()||x;if(e||((0,y.Ni)().selectEnd(),e=(0,y.vJ)()),e){(0,y.n1)(e.clone()),(0,y.vJ)().insertRawText(r),d.logWebUserEvent({actionName:"LyricsCowriteEditorInfillInserted",principalObjectType:"lyrics_request",principalObjectValue:a,context:{generateInstanceToken:i.createSessionToken,generatedLyrics:r,lyricsId:o}});let t=r.length,n=s.length,l=(0,S.A)((0,y.Ni)(),c.length?n:n+t),u=(0,S.A)((0,y.Ni)(),n+t);if(l&&u){let e=(0,y.uT)();e.setTextNodeRange(l.node,l.offset,u.node,u.offset),(0,y.n1)(e)}O({content:(0,y.Ni)().getTextContent(),id:o,requestId:a})}else d.logWebUserEvent({actionName:"LyricsCowriteEditorInfillNotInserted",principalObjectType:"lyrics_request",principalObjectValue:a,context:{reason:"Selection could not be created",generateInstanceToken:i.createSessionToken,generatedLyrics:r,lyricsId:o}});setTimeout(()=>l.focus(),100),I(!0)})},onError:e=>{z(),console.error(e)}}),[D,G]=(0,v.useState)(""),[U,Y]=(0,v.useState)(t.title);(0,v.useEffect)(()=>Y(t.title),[t.title]);let K=(0,v.useCallback)(e=>{l&&l.update(()=>{let t=(0,y.vJ)()||x;(0,y.I2)(t)||((0,y.Ni)().selectEnd(),t=(0,y.vJ)());let n=t.anchor.isBefore(t.focus)?t.anchor:t.focus,r=(0,y.uT)();r.setTextNodeRange((0,y.Ni)().getFirstChild(),0,n.getNode(),n.offset);let i=(0,y.uT)();i.setTextNodeRange(n.getNode(),n.offset,(0,y.Ni)().getLastChild(),(0,y.Ni)().getLastChild().getTextContentSize());let l=r.getTextContent(),o=i.getTextContent();H.mutate({title:U,prompt:D,prefix:l,edit:"",suffix:o,infillTransactionLogger:e})})},[l,H,U,D,x]),X=(0,v.useCallback)(e=>{l&&l.update(()=>{let t=(0,y.vJ)();if((0,y.I2)(t)){let n=t.getTextContent(),r=t.anchor.isBefore(t.focus)?t.anchor:t.focus,i=t.anchor.isBefore(t.focus)?t.focus:t.anchor,l=(0,y.uT)();l.setTextNodeRange((0,y.Ni)().getFirstChild(),0,r.getNode(),r.offset);let o=(0,y.uT)();o.setTextNodeRange(i.getNode(),i.offset,(0,y.Ni)().getLastChild(),(0,y.Ni)().getLastChild().getTextContentSize());let a=l.getTextContent(),s=o.getTextContent();H.mutate({prompt:D,prefix:a,edit:n,suffix:s,title:U,infillTransactionLogger:e})}else console.error("Invalid selection")})},[l,H,D,U,x]),J=(0,v.useCallback)(()=>{let e=_.current;if(!e)return;e.style.pointerEvents="none";let t=()=>{e.style.pointerEvents="",window.removeEventListener("mouseup",t)};window.addEventListener("mouseup",t)},[]),V=!!l;(0,v.useEffect)(()=>{let e=[l.registerCommand(y.Kf,e=>(a(e),!1),y.Ac),l.registerCommand(y.WW,e=>(p(e),!1),y.Ac),l.registerCommand(y.pF,()=>(I(!1),!1),y.Ac),l.registerCommand(y.$7,()=>(I(!0),!1),y.Ac),l.registerUpdateListener(()=>{l.read(()=>{let e=(0,y.vJ)();if(!(0,y.I2)(e)){E(!0);return}let t=null==e?void 0:e.getStartEndPoints();(null==t?void 0:t[0].getNode().__key)===(null==t?void 0:t[1].getNode().__key)&&(null==t?void 0:t[0].offset)===(null==t?void 0:t[1].offset)?E(!0):E(!1)})})];return()=>{e.forEach(e=>e())}},[l]),(0,v.useEffect)(()=>{let e=[l.registerCommand(y.ZK,(e,t)=>(t.read(()=>{(0,y.Ni)().getTextContent()===(null==B?void 0:B.content)&&(null==B?void 0:B.id)?(i.apiClient.POST("/api/generate/lyrics-infill/undo",{body:{lyrics_id:null==B?void 0:B.id}}),(0,d.Ay)({actionName:"LyricsCowriteEditorUndo",principalObjectType:"lyrics_request",principalObjectValue:B.requestId,context:{undidGeneratedInfill:!0,generateInstanceToken:i.createSessionToken}})):(0,d.Ay)({actionName:"LyricsCowriteEditorUndo",context:{undidGeneratedInfill:!1,generateInstanceToken:i.createSessionToken}})}),!1),y.Ac),l.registerCommand(y.V3,(e,t)=>{let n=t.registerUpdateListener(()=>{setTimeout(()=>{t.read(()=>{(0,y.Ni)().getTextContent()===(null==B?void 0:B.content)&&(null==B?void 0:B.id)?(i.apiClient.POST("/api/generate/lyrics-infill/redo",{body:{lyrics_id:null==B?void 0:B.id}}),(0,d.Ay)({actionName:"LyricsCowriteEditorRedo",principalObjectType:"lyrics_request",principalObjectValue:B.requestId,context:{redidGeneratedInfill:!0,generateInstanceToken:i.createSessionToken}})):(0,d.Ay)({actionName:"LyricsCowriteEditorRedo",context:{redidGeneratedInfill:!1,generateInstanceToken:i.createSessionToken}})})}),n()});return!1},y.Ac)];return()=>{e.forEach(e=>e())}},[l,B]);let[Z,ee]=(0,b.Mj)("lyrics-cowrite-info-dismissed-01-27-2025-v2",!1),[en,er]=(0,v.useState)("Enter a prompt");(0,v.useEffect)(()=>{L?er(ek[Math.floor(Math.random()*ek.length)]):er(eC[Math.floor(Math.random()*eC.length)])},[L]);let ei=(0,v.useCallback)(()=>{l.dispatchCommand(y.ZK,void 0)},[l,B]),el=(0,v.useCallback)(()=>{l.dispatchCommand(y.V3,void 0)},[l,B]);return(0,r.jsxs)(eh,{children:[(0,r.jsxs)(ex,{className:"bg-tertiary",children:[!Z&&(0,r.jsxs)(eb,{children:[(0,r.jsx)("p",{children:"Click “Write\xa0Here” to insert lyrics."}),(0,r.jsx)("p",{children:"When lyrics are selected, the button changes to “Rewrite”."}),(0,r.jsx)(u.Ay,{size:u.Mp.Mini,className:"opacity-50",onClick:()=>ee(!0),children:"Ok, got it"})]}),(0,r.jsx)(et,{ref:_,emphasizeSelection:!M,obscureSelection:H.isPending,children:V&&(0,r.jsxs)(ef,{children:[(0,r.jsx)(A.A,{className:"bg-transparent px-0",textAreaClassName:"bg-transparent px-0 py-0 mb-3",placeholder:'"'.concat(en,'"'),autoFocus:!0,value:D,rows:1,maxLength:256,onKeyDown:e=>{if("Enter"!==e.key||H.isPending)"z"===e.key&&(e.ctrlKey||e.metaKey)?(e.shiftKey?el():ei(),e.preventDefault()):"y"===e.key&&(e.ctrlKey||e.metaKey)&&(el(),e.preventDefault());else{e.preventDefault();let t=(0,d.$E)();L?(t.logWebUserEvent({actionName:"LyricsCowriteEditorWriteHere",context:{prompt:D,generateInstanceToken:i.createSessionToken}}),K(t)):(l.read(()=>{var e;t.logWebUserEvent({actionName:"LyricsCowriteEditorRewrite",context:{prompt:D,selectedText:(null===(e=(0,y.vJ)())||void 0===e?void 0:e.getTextContent())||"",generateInstanceToken:i.createSessionToken}})}),X(t))}},onChange:e=>G(e.currentTarget.value)}),(0,r.jsxs)("div",{className:"flex items-stretch justify-stretch",children:[D.length>0&&!H.isPending&&(0,r.jsx)(T.m,{label:"Clear prompt",children:(0,r.jsx)(u.Ay,{tabIndex:-1,size:u.Mp.Mini,variant:u.Ak.Tertiary,className:"bg-white bg-opacity-10 px-2 flex items-center",icon:(0,r.jsx)(h.d,{}),onClick:()=>{G(""),(0,d.Ay)({actionName:"LyricsCowriteEditorClearPromptButtonClicked",context:{generateInstanceToken:i.createSessionToken}})}})}),H.isPending&&(0,r.jsx)(u.Ay,{tabIndex:-1,size:u.Mp.Mini,variant:u.Ak.Tertiary,className:"bg-white bg-opacity-10 px-2 flex items-center",onClick:()=>{var e;z(),null===(e=W.current)||void 0===e||e.abort(),H.reset(),(0,d.Ay)({actionName:"LyricsCowriteEditorCancelInfillButtonClicked",context:{generateInstanceToken:i.createSessionToken}})},children:"Cancel"}),(0,r.jsx)("div",{className:"flex-grow"}),(0,r.jsx)(u.Ay,{disabled:H.isPending,tabIndex:-1,size:u.Mp.Mini,variant:u.Ak.DarkPrimary,className:"bg-white bg-opacity-10 h-8",icon:H.isPending?(0,r.jsx)(N.A,{}):(0,r.jsx)(C.Sup,{className:"text-fadedPink w-3 h-3"}),onClick:()=>{let e=(0,d.$E)();L?(l.read(()=>{e.logWebUserEvent({actionName:"LyricsCowriteEditorWriteHere",context:{prompt:D,generateInstanceToken:i.createSessionToken}})}),K(e)):(l.read(()=>{var t;e.logWebUserEvent({actionName:"LyricsCowriteEditorRewrite",context:{prompt:D,selectedText:(null===(t=(0,y.vJ)())||void 0===t?void 0:t.getTextContent())||"",generateInstanceToken:i.createSessionToken}})}),X(e))},children:H.isPending?"Writing...":L?"Write Here":"Rewrite"})]})]})}),!V&&(0,r.jsx)(eg,{children:"Select some lyrics to write with Suno"}),(0,r.jsx)(R,{above:!0,height:10,fadeHeight:30,color:"#252020"}),(0,r.jsx)(R,{above:!1,height:80,fadeHeight:30,color:"#252020"}),(0,r.jsx)(j.A,{className:"absolute bottom-3 left-3 right-3",value:"classic",onSetValue:()=>{},options:j.Z})]}),(0,r.jsxs)(em,{className:"bg-quaternary p-3",hideSelection:!M,onMouseDown:J,children:[(0,r.jsx)(ep,{value:U,onChange:e=>Y(e.currentTarget.value),placeholder:"Enter a title"}),(0,r.jsx)(Q,{onSelectionUpdate:P}),(0,r.jsxs)(ey,{children:[(0,r.jsx)(u.Ay,{className:"mr-2",shape:u.aH.Pill,variant:u.Ak.Secondary,onClick:()=>{l&&l.read(()=>{n(U,(0,y.Ni)().getTextContent())}),(0,d.Ay)({actionName:"LyricsCowriteEditorSaveChangesClicked",context:{generateInstanceToken:i.createSessionToken}})},children:"Save Changes"}),(0,r.jsx)(T.m,{label:"Undo Change (".concat(w.A," Z)"),children:(0,r.jsx)(u.Ay,{shape:u.aH.Pill,variant:u.Ak.Tertiary,disabled:!o,onClick:()=>{ei()},children:(0,r.jsx)(C.kUX,{})})}),(0,r.jsx)(T.m,{label:"Redo change (".concat(w.A," Shift Z)"),children:(0,r.jsx)(u.Ay,{shape:u.aH.Pill,variant:u.Ak.Tertiary,disabled:!s,onClick:()=>{el()},children:(0,r.jsx)(C.kUX,{style:{transform:"scaleX(-1)"}})})})]})]})]})}),ej=e=>(0,r.jsx)(m.n,{initialConfig:J,children:(0,r.jsx)(ew,{...e})}),eN=(0,s.PA)(e=>{let{genForm:t,createV2:n,session:s}=(0,c.gy)();return(0,r.jsxs)(l.Modal,{...e,size:"4xl",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1400]"}),(0,r.jsxs)(o.ModalContent,{bg:"#202020",overflow:"hidden",height:"calc(100vh - 130px)",children:[(0,r.jsx)(u.Ay,{variant:u.Ak.Tertiary,size:u.Mp.Mini,shape:u.aH.Rectangle,className:(0,a.A)("absolute z-10 py-2 rounded-lg top-1 right-1"),onClick:()=>{(0,d.Ay)({actionName:"LyricsCowriteEditorCloseButtonClicked",context:{generateInstanceToken:t.createSessionToken}}),e.onClose()},children:(0,r.jsx)(i.U,{className:"text-secondary"})}),(0,r.jsx)(ej,{content:{title:t.title,lyrics:t.lyrics},onSubmit:(r,i)=>{var l;t.setTitle(r),t.setLyrics(i),(null===(l=s.flags)||void 0===l?void 0:l["create-v1.5"])&&(n.setActiveTitle(r),n.setActiveLyrics(i)),e.onClose()}})]})]})})},91303:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(95155),i=n(5520),l=n(16299),o=n(52596),a=n(63438),s=n(12115),c=n(74955),d=n(56108),u=n(10250),p=n(8053),h=n(50649),x=n(1349),m=n(97942),f=n(15307);let g=e=>{let{children:t}=e;return(0,r.jsx)("h4",{className:"flex-grow-0 font-serif text-3xl",children:t})},y=e=>{let{id:t,requestId:n,text:i,title:l}=e;return(0,p.S)(t,n),(0,r.jsxs)("div",{className:"overflow-auto h-full tertiary-inner-vertical-fade",children:[l&&(0,r.jsx)("h4",{className:"text-md mt-4 opacity-50",children:l}),(0,r.jsx)("div",{className:"whitespace-pre-wrap text-sm text-secondary pb-20 pt-4",children:i.split("\n").map((e,t)=>(0,r.jsx)("p",{children:e||(0,r.jsx)(r.Fragment,{children:"\xa0"})},t))})]})},v=e=>{let{onAccept:t}=e;return(0,r.jsx)("div",{className:"flex-grow-0 flex items-center justify-center py-4",children:(0,r.jsx)(c.Ay,{size:c.Mp.Small,shape:c.aH.Pill,variant:c.Ak.Secondary,onClick:t,className:"px-8",children:"Select This Option"})})},b=e=>{let{id:t,requestId:n,title:i,text:l,onAccept:o,borderLeft:a}=e;return(0,r.jsxs)("div",{className:"flex flex-col justify-stretch align-stretch min-h-0 p-6 pb-0 relative",children:[a&&(0,r.jsx)("div",{className:"absolute top-2 left-0 bottom-6 w-[1px] bg-quaternary"}),(0,r.jsx)(g,{children:i}),(0,r.jsx)(y,{id:t,requestId:n,text:l}),(0,r.jsx)(v,{onAccept:o})]})},k=e=>{let{lyricsA:t,lyricsB:n,requestId:i,handleAcceptLyrics:l}=e,{logLyricsAccepted:o}=(0,p.A)();return(0,r.jsxs)(r.Fragment,{children:[(null==t?void 0:t.text)?(0,r.jsx)(b,{id:t.id,requestId:i,title:t.title,text:t.text,onAccept:()=>{l(i,t),o(i,t.id)}}):(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)(m.A,{})}),(null==n?void 0:n.text)?(0,r.jsx)(b,{borderLeft:!0,id:n.id,requestId:i,title:n.title,text:n.text,onAccept:()=>{l(i,n),o(i,n.id)}}):(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)(m.A,{})})]})},C=e=>{let{lyricsA:t,lyricsB:n,requestId:i,mobileTab:l,setMobileTab:a,handleAcceptLyrics:s}=e,c="a"===l?t:n,{logMobileOptionTabClick:d,logLyricsAccepted:u}=(0,p.A)();return(null==t?void 0:t.text)&&(null==n?void 0:n.text)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-stretch col-span-full gap-2 pt-2",children:[(0,r.jsx)("div",{className:(0,o.A)("bg-tertiary p-2 border-b border-b-quaternary text-secondary shrink-1 grow-0 overflow-hidden whitespace-nowrap text-ellipsis w-[50%]",{"border-b-white text-white":"a"===l}),onClick:()=>{a("a"),d(t.id)},children:t.title}),(0,r.jsx)("div",{className:(0,o.A)("bg-tertiary p-2 border-b border-b-quaternary text-secondary shrink-1 grow-0 overflow-hidden whitespace-nowrap text-ellipsis w-[50%]",{"border-b-white text-white":"b"===l}),onClick:()=>{a("b"),d(n.id)},children:n.title})]}),c&&(0,r.jsxs)("div",{className:"flex flex-col justify-stretch align-stretch min-h-0 col-span-full px-2",children:[(0,r.jsx)(y,{requestId:i,id:c.id,title:c.title,text:c.text}),(0,r.jsx)(v,{onAccept:()=>{s(i,c),u(i,c.id)}})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex items-center justify-center min-h-0 col-span-full",children:(0,r.jsx)(m.A,{})}),(0,r.jsx)("div",{className:"col-span-full"})]})},w=e=>{let{lyricsABFlow:t,onClose:n}=e,{prompt:i,setPrompt:l,lyricsModel:o,setLyricsModel:a,lyricsA:d,lyricsB:u,rejectLyricsIfNoneAccepted:g,requestId:y,generate:v,generating:b,cancel:k}=t,C=(0,p.A)(),w=(0,s.useMemo)(()=>b?"Writing...":"Write Lyrics",[b]);return(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"duration-300 pb-10 bg-quaternary rounded-md relative max-w-[560px] w-full",children:[(0,r.jsx)(f.A,{autoFocus:!0,value:i,maxLength:200,disabled:b,onChange:e=>l(e.target.value),placeholder:"Describe the lyrics you want, or share a theme or topic.",rows:2,onKeyDown:e=>{"Escape"===e.key?b||(n(),k(),d&&u&&y&&g(y),C.logEscapeKey(y)):"Enter"===e.key&&(e.preventDefault(),b||v(),d&&u&&y&&g(y),C.logEnterKey())},className:"bg-quaternary pb-2 pr-8 pl-5"}),(0,r.jsx)(h.Sup,{className:"absolute top-5 left-3 w-3 h-3 text-fadedPink"}),(0,r.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-2 flex align-middle justify-between",children:[b?(0,r.jsx)(c.Ay,{size:c.Mp.Small,shape:c.aH.Pill,variant:c.Ak.Secondary,onClick:()=>{k(),C.logCancelButton(y)},className:"pl-8 pr-8",children:"Cancel"}):(0,r.jsx)(x.A,{size:c.Mp.Small,value:o,onSetValue:e=>{a(e),C.logModelSelectorClick(e)},disabled:b}),(0,r.jsx)(c.Ay,{size:c.Mp.Small,shape:c.aH.Pill,variant:c.Ak.DarkPrimary,disabled:b,onClick:()=>{v(),d&&u&&y&&g(y),C.logGenerateButtonClick(i,o,y)},className:"whitespace-nowrap relative",icon:b?(0,r.jsx)(m.A,{width:18,height:18}):0===i.length?(0,r.jsx)(h.jGc,{className:"text-white w-3 h-3"}):(0,r.jsx)(h.qUP,{className:"text-white w-3 h-3"}),children:w})]})]})})},j=(0,a.PA)(e=>{let t=e.lyricsABFlow||(0,u.A)(),n=(0,p.A)(),{cancel:a,lyricsA:x,lyricsB:m,setLyricsADisplayed:f,setLyricsBDisplayed:g,rejectLyricsIfNoneAccepted:y,handleAcceptLyrics:v,requestId:b}=t,j=!(0,d.Yo)(),[N,A]=(0,s.useState)("a");(0,s.useEffect)(()=>{(null==x?void 0:x.text)&&(!j||j&&"a"===N)?f(!0):(null==x?void 0:x.text)||f(!1),(null==m?void 0:m.text)&&(!j||j&&"b"===N)?g(!0):(null==m?void 0:m.text)||g(!1)},[j,x,m,N,f,g]);let T=(0,s.useCallback)((t,n)=>{v(t,n),e.onClose()},[v,e.onClose]);return(0,r.jsxs)(i.Modal,{...e,size:"4xl",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1400]"}),(0,r.jsxs)(l.ModalContent,{bg:"#202020",marginTop:j?"0":void 0,marginBottom:j?"0":void 0,overflow:"hidden",height:j?"100svh":"calc(100vh - 130px)",children:[(0,r.jsx)(c.Ay,{variant:c.Ak.Tertiary,size:c.Mp.Mini,shape:c.aH.Rectangle,className:(0,o.A)("absolute z-10 py-2 rounded-lg",{"top-2 right-2":j,"top-1 right-1":!j}),onClick:()=>{e.onClose(),a(),x&&m&&b&&y(b),n.logLyricsModalClose(b)},children:(0,r.jsx)(h.USm,{className:"text-secondary"})}),(0,r.jsx)("div",{className:"w-[200%] grid grid-cols-2 absolute top-0 bottom-0 left-0 min-h-0 transition-all overflow-hidden",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 p-3 min-h-0 bg-tertiary",style:{gridTemplateRows:j?"auto 1fr":"1fr auto"},children:[!j&&(b?(0,r.jsx)(k,{lyricsA:x,lyricsB:m,handleAcceptLyrics:T,requestId:b}):(0,r.jsx)("div",{className:"flex flex-col items-center justify-center col-span-2 text-[#ffffff88]",children:(0,r.jsx)("p",{children:"Enter a prompt below to generate lyrics."})})),(0,r.jsx)("div",{className:"col-span-full flex items-end justify-between",children:(0,r.jsx)(w,{lyricsABFlow:t,onClose:e.onClose})}),j&&(b?(0,r.jsx)(C,{lyricsA:x,lyricsB:m,requestId:b,handleAcceptLyrics:T,mobileTab:N,setMobileTab:A}):(0,r.jsx)("div",{}))]})})]})]})})},94575:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(12115);let i=e=>{if("touches"in e){var t,n;return{clientX:(null===(t=e.touches[0])||void 0===t?void 0:t.clientX)||0,clientY:(null===(n=e.touches[0])||void 0===n?void 0:n.clientY)||0}}return{clientX:e.clientX,clientY:e.clientY}},l=function(e){let t=(0,r.useCallback)(t=>{let{clientX:n,clientY:r}=i(t),l=e({event:t,deltaXFromLast:0,deltaYFromLast:0,deltaXFromStart:0,deltaYFromStart:0,clientX:n,clientY:r});if(!l)return;t.preventDefault();let{onMouseUp:o,onMouseMove:a}=l,s=n,c=r,d=e=>{let{clientX:t,clientY:l}=i(e);null==a||a({event:e,deltaXFromLast:t-s,deltaYFromLast:l-c,deltaXFromStart:t-n,deltaYFromStart:l-r,clientX:t,clientY:l}),s=t,c=l},u=e=>{null==o||o({event:e,deltaXFromLast:0,deltaYFromLast:0,deltaXFromStart:s-n,deltaYFromStart:c-r,clientX:s,clientY:c}),window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",u)};window.addEventListener("mousemove",d,{passive:!1}),window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("mouseup",u,{passive:!1}),window.addEventListener("touchend",u,{passive:!1})},[e]);return(0,r.useCallback)(e=>{if(e)return e.addEventListener("mousedown",t,{passive:!1}),e.addEventListener("touchstart",t,{passive:!1}),()=>{e.removeEventListener("mousedown",t),e.removeEventListener("touchstart",t)}},[t])}}}]);